(self.webpackChunkomrat_client=self.webpackChunkomrat_client||[]).push([[189],{3980:(t,n,e)=>{var o=e(202);t.exports=(o.default||o).template({1:function(t,n,e,o,r){var i,a=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<owl:ObjectProperty rdf:about="#'+t.escapeExpression("function"==typeof(i=null!=(i=a(e,"title")||(null!=n?a(n,"title"):n))?i:t.hooks.helperMissing)?i.call(null!=n?n:t.nullContext||{},{name:"title",hash:{},data:r,loc:{start:{line:21,column:32},end:{line:21,column:43}}}):i)+'">\r\n  <rdfs:subPropertyOf rdf:resource="#has_relation"/>\r\n</owl:ObjectProperty>\r\n\r\n'},3:function(t,n,e,o,r){var i,a=null!=n?n:t.nullContext||{},s=t.hooks.helperMissing,c="function",l=t.escapeExpression,u=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<owl:Class rdf:about="#'+l(typeof(i=null!=(i=u(e,"title")||(null!=n?u(n,"title"):n))?i:s)===c?i.call(a,{name:"title",hash:{},data:r,loc:{start:{line:60,column:23},end:{line:60,column:34}}}):i)+'_cls">\r\n  <rdfs:subClassOf rdf:resource="#DataClass"/>\r\n  <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string">'+l(typeof(i=null!=(i=u(e,"title")||(null!=n?u(n,"title"):n))?i:s)===c?i.call(a,{name:"title",hash:{},data:r,loc:{start:{line:62,column:69},end:{line:62,column:80}}}):i)+"</rdfs:label>\r\n</owl:Class>\r\n\r\n<"+l(typeof(i=null!=(i=u(e,"title")||(null!=n?u(n,"title"):n))?i:s)===c?i.call(a,{name:"title",hash:{},data:r,loc:{start:{line:65,column:1},end:{line:65,column:12}}}):i)+'_cls rdf:about="#'+l(typeof(i=null!=(i=u(e,"title")||(null!=n?u(n,"title"):n))?i:s)===c?i.call(a,{name:"title",hash:{},data:r,loc:{start:{line:65,column:29},end:{line:65,column:40}}}):i)+'">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#NamedIndividual"/>\r\n  <rdfs:label rdf:datatype="http://www.w3.org/2001/XMLSchema#string">'+l(typeof(i=null!=(i=u(e,"title")||(null!=n?u(n,"title"):n))?i:s)===c?i.call(a,{name:"title",hash:{},data:r,loc:{start:{line:67,column:69},end:{line:67,column:80}}}):i)+'</rdfs:label>\r\n  <has_idx rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">'+l(typeof(i=null!=(i=u(e,"id")||(null!=n?u(n,"id"):n))?i:s)===c?i.call(a,{name:"id",hash:{},data:r,loc:{start:{line:68,column:67},end:{line:68,column:75}}}):i)+"</has_idx>\r\n</"+l(typeof(i=null!=(i=u(e,"title")||(null!=n?u(n,"title"):n))?i:s)===c?i.call(a,{name:"title",hash:{},data:r,loc:{start:{line:69,column:2},end:{line:69,column:13}}}):i)+"_cls>\r\n\r\n"},5:function(t,n,e,o,r){var i,a=t.lambda,s=t.escapeExpression,c=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<BB rdf:about="#'+s(a(null!=(i=null!=n?c(n,"annotation"):n)?c(i,"id"):i,n))+'">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#NamedIndividual"/>\r\n  <has_cls rdf:resource="#'+s(a(null!=(i=null!=(i=null!=n?c(n,"annotation"):n)?c(i,"klass"):i)?c(i,"title"):i,n))+'"/>\r\n'+(null!=(i=c(e,"each").call(null!=n?n:t.nullContext||{},null!=n?c(n,"relations"):n,{name:"each",hash:{},fn:t.program(6,r,0),inverse:t.noop,data:r,loc:{start:{line:76,column:2},end:{line:78,column:12}}}))?i:"")+'  <has_idx rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">'+s(a(null!=(i=null!=n?c(n,"annotation"):n)?c(i,"id"):i,n))+'</has_idx>\r\n  <has_x rdf:datatype="http://www.w3.org/2001/XMLSchema#decimal">'+s(a(null!=(i=null!=n?c(n,"annotation"):n)?c(i,"normalX"):i,n))+'</has_x>\r\n  <has_y rdf:datatype="http://www.w3.org/2001/XMLSchema#decimal">'+s(a(null!=(i=null!=n?c(n,"annotation"):n)?c(i,"normalY"):i,n))+'</has_y>\r\n  <has_w rdf:datatype="http://www.w3.org/2001/XMLSchema#decimal">'+s(a(null!=(i=null!=n?c(n,"annotation"):n)?c(i,"normalWidth"):i,n))+'</has_w>\r\n  <has_h rdf:datatype="http://www.w3.org/2001/XMLSchema#decimal">'+s(a(null!=(i=null!=n?c(n,"annotation"):n)?c(i,"normalHeight"):i,n))+"</has_h>\r\n</BB>\r\n\r\n"},6:function(t,n,e,o,r){var i,a=t.lambda,s=t.escapeExpression,c=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return"  <"+s(a(null!=(i=null!=n?c(n,"klass"):n)?c(i,"title"):i,n))+' rdf:resource="#'+s(a(null!=(i=null!=n?c(n,"output"):n)?c(i,"id"):i,n))+'"/>\r\n'},compiler:[8,">= 4.3.0"],main:function(t,n,e,o,r){var i,a=null!=n?n:t.nullContext||{},s=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<?xml version="1.0"?>\r\n<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"\r\n         xmlns:xsd="http://www.w3.org/2001/XMLSchema#"\r\n         xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"\r\n         xmlns:owl="http://www.w3.org/2002/07/owl#"\r\n         xml:base="http://fbctene.pl/sg"\r\n         xmlns="http://fbctene.pl/sg#">\r\n\r\n<owl:Ontology rdf:about="http://fbctene.pl/sg"/>\r\n\r\n<owl:ObjectProperty rdf:about="#has_cls">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#FunctionalProperty"/>\r\n  <rdfs:range rdf:resource="#DataClass"/>\r\n</owl:ObjectProperty>\r\n\r\n<owl:ObjectProperty rdf:about="#has_relation">\r\n  <rdfs:range rdf:resource="#DataClass"/>\r\n</owl:ObjectProperty>\r\n\r\n'+(null!=(i=s(e,"each").call(a,null!=n?s(n,"relations"):n,{name:"each",hash:{},fn:t.program(1,r,0),inverse:t.noop,data:r,loc:{start:{line:20,column:0},end:{line:25,column:10}}}))?i:"")+'<owl:DatatypeProperty rdf:about="#has_idx">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#FunctionalProperty"/>\r\n  <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#integer"/>\r\n</owl:DatatypeProperty>\r\n\r\n<owl:DatatypeProperty rdf:about="#has_x">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#FunctionalProperty"/>\r\n  <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#decimal"/>\r\n</owl:DatatypeProperty>\r\n\r\n<owl:DatatypeProperty rdf:about="#has_y">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#FunctionalProperty"/>\r\n  <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#decimal"/>\r\n</owl:DatatypeProperty>\r\n\r\n<owl:DatatypeProperty rdf:about="#has_w">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#FunctionalProperty"/>\r\n  <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#decimal"/>\r\n</owl:DatatypeProperty>\r\n\r\n<owl:DatatypeProperty rdf:about="#has_h">\r\n  <rdf:type rdf:resource="http://www.w3.org/2002/07/owl#FunctionalProperty"/>\r\n  <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#decimal"/>\r\n</owl:DatatypeProperty>\r\n\r\n<owl:Class rdf:about="#BB">\r\n  <rdfs:subClassOf rdf:resource="http://www.w3.org/2002/07/owl#Thing"/>\r\n</owl:Class>\r\n\r\n<owl:Class rdf:about="#DataClass">\r\n  <rdfs:subClassOf rdf:resource="http://www.w3.org/2002/07/owl#Thing"/>\r\n</owl:Class>\r\n\r\n'+(null!=(i=s(e,"each").call(a,null!=n?s(n,"classes"):n,{name:"each",hash:{},fn:t.program(3,r,0),inverse:t.noop,data:r,loc:{start:{line:59,column:0},end:{line:71,column:10}}}))?i:"")+(null!=(i=s(e,"each").call(a,null!=n?s(n,"annotations"):n,{name:"each",hash:{},fn:t.program(5,r,0),inverse:t.noop,data:r,loc:{start:{line:72,column:0},end:{line:86,column:9}}}))?i:"")+"\r\n</rdf:RDF>\r\n"},useData:!0})},6400:(t,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>Et});var o,r=e(9755),i=e.n(r),a=e(7268),s=e(9734),c=e.n(s);function l(t,n){var e=9/n,o=Math.min(t.x,t.x+t.width),r=Math.max(t.x,t.x+t.width),i=Math.min(t.y,t.y+t.height),a=Math.max(t.y,t.y+t.height);return[{x:o-e,y:i-e,lockX:!1,lockY:!1,resizeCenterX:r,resizeCenterY:a,edgeX:o,edgeY:i,direction:"topLeft"},{x:r+e,y:i-e,lockX:!1,lockY:!1,resizeCenterX:o,resizeCenterY:a,edgeX:r,edgeY:i,direction:"topRight"},{x:o-e,y:a+e,lockX:!1,lockY:!1,resizeCenterX:r,resizeCenterY:i,edgeX:o,edgeY:a,direction:"bottomLeft"},{x:r+e,y:a+e,lockX:!1,lockY:!1,resizeCenterX:o,resizeCenterY:i,edgeX:r,edgeY:a,direction:"bottomRight"},{x:o+Math.abs(t.width)/2,y:i-e,lockX:!0,lockY:!1,resizeCenterX:r,resizeCenterY:a,edgeX:o+Math.abs(t.width)/2,edgeY:i,direction:"top"},{x:o-e,y:i+Math.abs(t.height)/2,lockX:!1,lockY:!0,resizeCenterX:r,resizeCenterY:a,edgeX:o,edgeY:i+Math.abs(t.height)/2,direction:"left"},{x:r+e,y:i+Math.abs(t.height)/2,lockX:!1,lockY:!0,resizeCenterX:o,resizeCenterY:i,edgeX:r,edgeY:i+Math.abs(t.height)/2,direction:"right"},{x:o+Math.abs(t.width)/2,y:a+e,lockX:!0,lockY:!1,resizeCenterX:o,resizeCenterY:i,edgeX:o+Math.abs(t.width)/2,edgeY:a,direction:"bottom"}]}function u(t,n){return t.pageX/n.zoom+n.scrollX}function h(t,n){return t.pageY/n.zoom+n.scrollY}function p(t,n,e){var o=u(n,e),r=h(n,e);return l(t,e.zoom).find((function(t){return Math.hypot(t.x-o,t.y-r)<=7/e.zoom}))}!function(t){t.CURSOR="cursor",t.MARK="mark",t.GROUP="group"}(o||(o={}));var f=2*Math.PI;const d=function(){function t(t){this.arrowSize=0,this.arrowDashSize=0,this.defaultLineWidth=0,this.ctx=t,this.params={width:0,height:0,zoom:1,scrollX:0,scrollY:0,mode:o.CURSOR,pointerX:0,pointerY:0}}return t.prototype.start=function(){var t=this.params,n=t.width,e=t.height,o=t.zoom,r=t.scrollX,i=t.scrollY;this.ctx.clearRect(0,0,n,e),this.ctx.scale(o,o),this.ctx.translate(-r,-i),this.ctx.font="".concat(12/this.params.zoom,"px ").concat("Verdana, sans-serif"),this.arrowSize=20/this.params.zoom,this.arrowDashSize=10/this.params.zoom,this.defaultLineWidth=2/this.params.zoom},t.prototype.drawImage=function(t){this.ctx.drawImage(t,0,0)},t.prototype.drawObjects=function(t,n){var e=this;this.ctx.lineWidth=this.defaultLineWidth,t.eachObject((function(t){n.has(t.klass)&&(e.ctx.strokeStyle=t.klass.color,e.ctx.strokeRect(t.x,t.y,t.width,t.height))}))},t.prototype.drawRelations=function(t,n){var e=this;this.ctx.lineWidth=this.defaultLineWidth;var o=this.arrowSize;t.eachRelation((function(t){n.has(t.input.klass)&&n.has(t.output.klass)&&e.drawRelation(t,!0,o)}))},t.prototype.drawFocusedObject=function(t){var n=this.params.zoom;this.ctx.fillStyle="".concat(t.klass.color,"40"),this.ctx.fillRect(t.x,t.y,t.width,t.height);var e=this.ctx.measureText(t.klass.title).width;this.ctx.fillStyle="black",this.ctx.fillRect(t.x,t.y,e+6/n,18/n),this.ctx.fillStyle="white",this.ctx.strokeStyle="white",this.ctx.textBaseline="hanging",this.ctx.fillText(t.klass.title,t.x+3/n,t.y+3/n)},t.prototype.drawSelectedObject=function(t){var n=this,e=this.params.zoom;this.ctx.strokeStyle=t.klass.color,this.ctx.lineWidth=5/e,this.ctx.strokeRect(t.x,t.y,t.width,t.height),this.ctx.fillStyle="".concat(t.klass.color,"40"),this.ctx.fillRect(t.x,t.y,t.width,t.height),l(t,e).forEach((function(o){n.ctx.strokeStyle="".concat(t.klass.color,"40"),n.ctx.fillStyle=t.klass.color,n.ctx.beginPath(),n.ctx.arc(o.x,o.y,7/e,0,f),n.ctx.fill(),n.ctx.stroke()}))},t.prototype.end=function(){this.ctx.resetTransform()},t.prototype.drawRelation=function(t,n,e){void 0===n&&(n=!0),void 0===e&&(e=this.arrowSize);var o=t.input.centerPixelX,r=t.input.centerPixelY;this.drawArrow(o,r,t.output.centerPixelX,t.output.centerPixelY,t.klass.color,!n,e)},t.prototype.drawArrow=function(t,n,e,o,r,i,a){this.ctx.strokeStyle=r;var s=this.ctx.getTransform(),c=Math.atan2(o-n,e-t),l=Math.hypot(o-n,e-t),u=a||this.arrowSize;i?this.ctx.setLineDash([this.arrowDashSize]):this.ctx.setLineDash([]),this.ctx.translate(e,o),this.ctx.rotate(c-Math.PI/2),this.ctx.beginPath(),this.ctx.moveTo(0,-l),this.ctx.lineTo(0,0),this.ctx.lineTo(-u,-u),this.ctx.lineTo(0,0),this.ctx.lineTo(u,-u),this.ctx.stroke(),this.ctx.setLineDash([]),this.ctx.setTransform(s)},t.prototype.drawRelationAbsence=function(t,n){var e=this.ctx.measureText("X").width,o=this.ctx.getTransform();this.ctx.translate(t-5*e/2,n),this.ctx.scale(5,5),this.ctx.textBaseline="middle",this.ctx.fillStyle="red",this.ctx.fillText("X",0,0),this.ctx.setTransform(o)},t}();var v,y=e(9564),m=e(9537),w=e(6480),g=e(19),b=(v=function(t,n){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},v(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}v(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});const C=function(t){function n(n,e){var o=t.call(this)||this;return o.visibleClasses=new Set,o.image=e,o.renderer=new d(n),o.annotationCollection=new m.Z(e.title),o.annotationCollection.dimensions={width:o.image.width,height:o.image.height},g.s.forEach((function(t){return o.visibleClasses.add(t)})),o}return b(n,t),n.prototype.clear=function(){this.collection.clear(),delete this.selected,delete this.focusedObject},n.prototype.render=function(t){if(this.renderer.params=t,this.renderer.start(),this.renderer.drawImage(this.image),this.renderer.drawObjects(this.collection,this.visibleClasses),this.renderer.drawRelations(this.collection,this.visibleClasses),this.focusedObject&&this.renderer.drawFocusedObject(this.focusedObject),this.selectedObject&&this.renderer.drawSelectedObject(this.selectedObject),t.mode===o.GROUP&&this.selectedObject){var n=t.relationClass;if(!n)return;if(this.focusedObject)this.collection.hasRelation(n,this.selectedObject,this.focusedObject)?this.renderer.drawRelationAbsence(this.focusedObject.centerPixelX,this.focusedObject.centerPixelY):this.renderer.drawRelation(new y.Z(n,this.selectedObject,this.focusedObject),!1);else{var e=this.selectedObject.centerPixelX,r=this.selectedObject.centerPixelY;this.renderer.drawArrow(e,r,t.pointerX,t.pointerY,n.color,!0)}}this.renderer.end()},n.prototype.removeAnnotation=function(t){this.collection.removeAnnotation(t),this.selected===t&&(this.selectedObject=void 0)},n.prototype.setClassVisibility=function(t,n){n?this.visibleClasses.add(t):this.visibleClasses.delete(t)},n.prototype.toggleAnnotationsVisibility=function(t){var n=this;return void 0===t&&(t=g.s.some((function(t){return!n.visibleClasses.has(t)}))),t?g.s.forEach((function(t){return n.visibleClasses.add(t)})):g.s.forEach((function(t){return n.visibleClasses.delete(t)})),t},n.prototype.getClassVisibility=function(t){return this.visibleClasses.has(t)},Object.defineProperty(n.prototype,"collection",{get:function(){return this.annotationCollection},set:function(t){this.annotationCollection=t,this.annotationCollection.dimensions={width:this.image.width,height:this.image.height}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"annotatedImage",{get:function(){return this.image},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selectedObject",{get:function(){return this.selected},set:function(t){this.selected=t,this.emit("selectedObject")},enumerable:!1,configurable:!0}),n}(w.Z);var O=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),_=function(){return _=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},_.apply(this,arguments)};const j=function(t){function n(n){var e=t.call(this)||this;e.scrollX=0,e.scrollY=0,e.zoom=1,e.pageImages=[],e.currentPageId=0,e.pagesCollection=[],e.navigationParams={mode:o.CURSOR,pointerX:0,pointerY:0};var r=n.get(0);if(!r)throw new Error("HTMLCanvasElement is missing");e.canvas=r;var i=r.getContext("2d");if(!i)throw new Error("HTMLCanvasElement context is missing");return e.ctx=i,e.images=[],e.selectedObject=e.selectedObject.bind(e),e}return O(n,t),n.prototype.render=function(t){void 0===t&&(t={});var n=this.currentPage;this.navigationParams=Object.assign(this.navigationParams,t),n&&n.render(_({width:this.canvas.width,height:this.canvas.height,zoom:this.zoom,scrollX:this.scrollX,scrollY:this.scrollY},this.navigationParams))},n.prototype.selectedObject=function(){this.emit("selectedObject")},Object.defineProperty(n.prototype,"images",{get:function(){return this.pageImages},set:function(t){var n=this;this.pageImages.length&&!window.confirm(a.ZP.t("load_new_images_confirm"))||(this.pageImages=t,this.pagesCollection=t.map((function(t){return new C(n.ctx,t)})),t.length?(this.imageId=this.currentPageId,i()(".total-images-count").text(t.length.toString()),i()(".pagination").show()):i()(".pagination").hide(),this.scrollX=0,this.scrollY=0,this.emit("images"))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"annotations",{set:function(t){var n=this;t.forEach((function(t){var e=n.pagesCollection.find((function(n){return n.annotatedImage.title===t.imageTitle}));e&&(e.collection=t)})),this.render()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"imageId",{get:function(){return this.currentPageId},set:function(t){var n;this.pagesCollection.length&&(null===(n=this.currentPage)||void 0===n||n.off("selectedObject",this.selectedObject),this.currentPageId=t%this.pagesCollection.length,this.currentPageId<0&&(this.currentPageId+=this.pagesCollection.length),this.currentPage.on("selectedObject",this.selectedObject),this.emit("selectedObject"),i()(".current-image-id").text((this.currentPageId+1).toString()),i()(".image-title").text(this.currentPage.annotatedImage.title),this.emit("imagechange"),this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"element",{get:function(){return this.canvas.parentElement},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"plane",{get:function(){return this.canvas},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentPage",{get:function(){return this.pagesCollection[this.currentPageId]},enumerable:!1,configurable:!0}),n}(w.Z),x=function(t){this.annotationCanvas=t};var P=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const k=function(t){function n(n){var e=t.call(this,n)||this;return e.objectsCollectionRoot=i()(".annotation-label-visibility-list").get(0),e.change=e.change.bind(e),e.imageChanged=e.imageChanged.bind(e),g.s.forEach((function(t){return e.appendClass(t)})),e}return P(n,t),n.prototype.on=function(){var t,n=this;null===(t=this.annotationCanvas.currentPage)||void 0===t||t.toggleAnnotationsVisibility(!0),i()("ul.annotation-label-visibility-list > li").each((function(t,e){e.addEventListener("change",n.change);var o=e.querySelector("input");o&&(o.checked=!0)})),this.annotationCanvas.on("imagechange",this.imageChanged)},n.prototype.off=function(){var t=this;i()("ul.annotation-label-visibility-list > li").each((function(n,e){e.removeEventListener("change",t.change)})),this.annotationCanvas.off("imagechange",this.imageChanged)},n.prototype.change=function(t){var n=t.target,e=n.checked,o=this.annotationCanvas.currentPage;if("all"===n.value){var r=o.toggleAnnotationsVisibility();i()("ul.annotation-label-visibility-list > li input").each((function(t,n){n.checked=r}))}else{var a=g.s[parseInt(n.value,10)];o.setClassVisibility(a,e)}this.annotationCanvas.render()},n.prototype.appendClass=function(t){var n=document.querySelector("ul.annotation-label-visibility-list > template").content.querySelector("li"),e=document.importNode(n,!0);this.objectsCollectionRoot.appendChild(e);var o=e.querySelector("input"),r="class-visibility-".concat(t.id);o.setAttribute("value","".concat(t.id)),o.setAttribute("id",r);var i=e.querySelector("label");i.setAttribute("for",r),i.innerText=t.title},n.prototype.imageChanged=function(){var t=this.annotationCanvas.currentPage;t&&i()("ul.annotation-label-visibility-list > li input").each((function(n,e){var o=e;"all"!==o.value&&(o.checked=t.getClassVisibility(g.s[parseInt(o.value,10)]))}))},n}(x);var E=e(7012);function L(t){return t.composedPath().every((function(t){var n=t;return"ASIDE"!==n.tagName&&"NAV"!==n.tagName}))}var S=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const X=function(t){function n(n){var e=t.call(this,n)||this;return e.down=e.down.bind(e),e.up=e.up.bind(e),e.scroll=e.scroll.bind(e),e}return S(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("mousedown",this.down)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("mousedown",this.down)},n.prototype.down=function(t){var n;L(t)&&(this.clickedObject=null===(n=this.annotationCanvas.currentPage)||void 0===n?void 0:n.focusedObject,this.annotationCanvas.element.addEventListener("mousemove",this.scroll),this.annotationCanvas.element.addEventListener("mouseup",this.up))},n.prototype.scroll=function(t){this.clickedObject&&(this.clickedObject.x+=t.movementX/this.annotationCanvas.zoom,this.clickedObject.y+=t.movementY/this.annotationCanvas.zoom,this.annotationCanvas.render())},n.prototype.up=function(){this.annotationCanvas.element.removeEventListener("mousemove",this.scroll),this.annotationCanvas.element.removeEventListener("mouseup",this.up),this.clickedObject&&E.Z.instance.check(13)},n}(x);var Y=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const z=function(t){function n(n){var e=t.call(this,n)||this;return e.cornerOffsetX=0,e.cornerOffsetY=0,e.down=e.down.bind(e),e.up=e.up.bind(e),e.scroll=e.scroll.bind(e),e}return Y(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("mousedown",this.down)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("mousedown",this.down)},n.prototype.down=function(t){var n,e;L(t)&&(null===(n=this.annotation)||void 0===n||n.absolutizeDimensions(),this.annotation=null===(e=this.annotationCanvas.currentPage)||void 0===e?void 0:e.selectedObject,this.annotation&&(this.pulley=p(this.annotation,t,this.annotationCanvas),this.pulley&&(this.cornerOffsetX=this.pulley.edgeX-u(t,this.annotationCanvas),this.cornerOffsetY=this.pulley.edgeY-h(t,this.annotationCanvas),(this.pulley.resizeCenterX<this.annotation.x||"top"===this.pulley.direction)&&(this.annotation.width=-this.annotation.width),(this.pulley.resizeCenterY<this.annotation.y||"left"===this.pulley.direction)&&(this.annotation.height=-this.annotation.height),this.annotation.x=this.pulley.resizeCenterX,this.annotation.y=this.pulley.resizeCenterY,this.annotationCanvas.element.addEventListener("mousemove",this.scroll),this.annotationCanvas.element.addEventListener("mouseup",this.up))))},n.prototype.scroll=function(t){if(this.annotation&&this.pulley){var n=u(t,this.annotationCanvas)-this.annotation.x+this.cornerOffsetX||1,e=h(t,this.annotationCanvas)-this.annotation.y+this.cornerOffsetY||1;if(!t.ctrlKey||this.pulley.lockX||this.pulley.lockY)this.pulley.lockX||(this.annotation.width=n),this.pulley.lockY||(this.annotation.height=e);else{var o=Math.max(Math.abs(n),Math.abs(e));this.annotation.width=(n>0?1:-1)*o,this.annotation.height=(e>0?1:-1)*o}this.annotationCanvas.render()}},n.prototype.up=function(){this.annotationCanvas.element.removeEventListener("mousemove",this.scroll),this.annotationCanvas.element.removeEventListener("mouseup",this.up),this.annotation&&this.annotation.absolutizeDimensions()},n}(x);var M=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const T=function(t){function n(n){var e=t.call(this,n)||this;return e.position=new X(n),e.size=new z(n),e}return M(n,t),n.prototype.on=function(){this.position.on(),this.size.on()},n.prototype.off=function(){this.position.off(),this.size.off()},n}(x);function R(t,n){t.forEach((function(t){var e=document.createElement("option");e.innerText=t.title,e.value=t.id.toString(),n.append(e)}))}var A=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),D=function(){return E.Z.instance.check(8)};const I=function(t){function n(n){var e=t.call(this,n)||this;return e.labelSelect=i()(".mark-properties .annotation-label-select").get(0),e.down=e.down.bind(e),e.up=e.up.bind(e),e.scroll=e.scroll.bind(e),R(g.s,e.labelSelect),e}return A(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("mousedown",this.down),i()(".mark-properties").show(),i()(document.body).addClass("aiming"),this.labelSelect.addEventListener("change",D)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("mousedown",this.down),i()(".mark-properties").hide(),i()(document.body).removeClass("aiming"),this.labelSelect.removeEventListener("change",D)},n.prototype.down=function(t){var n;if(L(t)){var e=this.annotationCanvas.currentPage;e&&(null===(n=this.annotation)||void 0===n||n.absolutizeDimensions(),this.annotation=e.collection.createAnnotationObject(this.currentClass),this.annotation.x=this.cursorToCanvasX(t),this.annotation.y=this.cursorToCanvasY(t),this.annotationCanvas.element.addEventListener("mousemove",this.scroll),this.annotationCanvas.element.addEventListener("mouseup",this.up))}},n.prototype.scroll=function(t){if(this.annotation){var n=this.cursorToCanvasX(t)-this.annotation.x||1,e=this.cursorToCanvasY(t)-this.annotation.y||1;if(t.ctrlKey){var o=Math.max(Math.abs(n),Math.abs(e));this.annotation.width=(n>0?1:-1)*o,this.annotation.height=(e>0?1:-1)*o}else this.annotation.width=n,this.annotation.height=e;this.annotationCanvas.render()}},n.prototype.up=function(){this.annotationCanvas.element.removeEventListener("mousemove",this.scroll),this.annotationCanvas.element.removeEventListener("mouseup",this.up);var t=this.annotationCanvas.currentPage;this.annotation&&(this.annotation.absolutizeDimensions(),E.Z.instance.check(9)),t&&(t.selectedObject=this.annotation,this.annotationCanvas.render())},Object.defineProperty(n.prototype,"currentClass",{get:function(){return g.s[parseInt(this.labelSelect.value,10)]},enumerable:!1,configurable:!0}),n.prototype.cursorToCanvasX=function(t){return t.pageX/this.annotationCanvas.zoom+this.annotationCanvas.scrollX},n.prototype.cursorToCanvasY=function(t){return t.pageY/this.annotationCanvas.zoom+this.annotationCanvas.scrollY},n}(x);var Z=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const F=function(t){function n(n){var e=t.call(this,n)||this;return e.down=e.down.bind(e),e.up=e.up.bind(e),e.scroll=e.scroll.bind(e),e}return Z(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("mousedown",this.down)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("mousedown",this.down)},n.prototype.down=function(t){if(L(t)){var n=this.annotationCanvas.currentPage;if(!(null==n?void 0:n.focusedObject)){if((null==n?void 0:n.selectedObject)&&p(n.selectedObject,t,this.annotationCanvas))return;this.annotationCanvas.element.addEventListener("mousemove",this.scroll),this.annotationCanvas.element.addEventListener("mouseup",this.up)}}},n.prototype.scroll=function(t){this.annotationCanvas.scrollX-=t.movementX/this.annotationCanvas.zoom,this.annotationCanvas.scrollY-=t.movementY/this.annotationCanvas.zoom,this.annotationCanvas.render()},n.prototype.up=function(){this.annotationCanvas.element.removeEventListener("mousemove",this.scroll),this.annotationCanvas.element.removeEventListener("mouseup",this.up),E.Z.instance.check(3)},n}(x);var U=e(2762),B=e.n(U),V=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const W=function(t){function n(n){var e=t.call(this,n)||this;return e.movement=e.movement.bind(e),e}return V(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("mousemove",this.movement)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("mousemove",this.movement)},n.prototype.movement=function(t){var n=this.annotationCanvas.currentPage;if(n){var e=t.pageX/this.annotationCanvas.zoom+this.annotationCanvas.scrollX,o=t.pageY/this.annotationCanvas.zoom+this.annotationCanvas.scrollY,r=[];n.collection.eachObject((function(t){n.getClassVisibility(t.klass)&&r.push(t)}));var i=function(t,n,e){var o=t.filter((function(t){return t.isPixelIn(n,e)}));return B()(o,(function(t){return t.distanceToPixelEdge(n,e)}))}(r,e,o);i!==n.focusedObject&&(n.focusedObject=i,this.annotationCanvas.render())}},n}(x);var K=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const N=function(t){function n(n){var e=t.call(this,n)||this;return e.canvasFocus=new W(n),e.down=e.down.bind(e),e}return K(n,t),n.prototype.on=function(){this.canvasFocus.on(),this.annotationCanvas.element.addEventListener("mousedown",this.down)},n.prototype.off=function(){this.canvasFocus.off(),this.annotationCanvas.element.removeEventListener("mousedown",this.down)},n.prototype.movement=function(t){this.canvasFocus.movement(t)},n.prototype.down=function(t){if(L(t)){var n=this.annotationCanvas.currentPage;if(n){if(n.selectedObject&&p(n.selectedObject,t,this.annotationCanvas))return;n.selectedObject!==n.focusedObject&&(n.selectedObject=n.focusedObject,this.annotationCanvas.render(),n.selectedObject?E.Z.instance.check(11):E.Z.instance.check(12))}}},n}(x);var q=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const G=function(t){function n(n){var e=t.call(this,n)||this;return e.labelSelect=i()(".relation-label-select").get(0),e.cursorCanvasSelection=new N(n),e.labelChange=e.labelChange.bind(e),e.down=e.down.bind(e),e.movement=e.movement.bind(e),R(g.a,e.labelSelect),e}return q(n,t),n.prototype.on=function(){this.labelSelect.addEventListener("change",this.labelChange),this.labelChange(),this.annotationCanvas.element.addEventListener("mousemove",this.movement),this.annotationCanvas.element.addEventListener("mousedown",this.down),i()(".group-properties").show()},n.prototype.off=function(){this.labelSelect.removeEventListener("change",this.labelChange),this.annotationCanvas.element.removeEventListener("mousemove",this.movement),this.annotationCanvas.element.removeEventListener("mousedown",this.down),i()(".group-properties").hide()},n.prototype.labelChange=function(){this.annotationCanvas.render({relationClass:this.currentClass}),E.Z.instance.check(17)},n.prototype.down=function(t){if(L(t)){var n=this.annotationCanvas.currentPage;if(n){var e=n.selectedObject,o=n.focusedObject;if(e&&o&&e!==o){var r=g.a[parseInt(this.labelSelect.value,10)];n.collection.switchRelation(r,e,o),n.selectedObject=o,this.annotationCanvas.render(),n.collection.hasRelation(r,e,o)?E.Z.instance.check(18):E.Z.instance.check(19)}else this.cursorCanvasSelection.down(t)}}},n.prototype.movement=function(t){this.cursorCanvasSelection.movement(t)},Object.defineProperty(n.prototype,"currentClass",{get:function(){return g.a[parseInt(this.labelSelect.value,10)]},enumerable:!1,configurable:!0}),n}(x);var H=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const J=function(t){function n(n){var e=t.call(this,n)||this;return e.movement=e.movement.bind(e),e}return H(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("mousemove",this.movement)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("mousemove",this.movement)},n.prototype.movement=function(t){var n=t.pageX/this.annotationCanvas.zoom+this.annotationCanvas.scrollX,e=t.pageY/this.annotationCanvas.zoom+this.annotationCanvas.scrollY;this.annotationCanvas.render({pointerX:n,pointerY:e})},n}(x);var Q=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const $=function(t){function n(n){var e=t.call(this,n)||this;return e.keyDown=e.keyDown.bind(e),e}return Q(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("keydown",this.keyDown)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("keydown",this.keyDown)},n.prototype.keyDown=function(t){var n=this.annotationCanvas.currentPage;if(null==n?void 0:n.selectedObject){var e=!0;"Delete"===t.key?(n.removeAnnotation(n.selectedObject),E.Z.instance.check(15)):"ArrowLeft"===t.key?(n.selectedObject.x--,E.Z.instance.check(13)):"ArrowRight"===t.key?(n.selectedObject.x++,E.Z.instance.check(13)):"ArrowDown"===t.key?(n.selectedObject.y++,E.Z.instance.check(13)):"ArrowUp"===t.key?(n.selectedObject.y--,E.Z.instance.check(13)):"d"===t.key&&t.ctrlKey?(t.preventDefault(),n.selectedObject=n.collection.cloneAnnotation(n.selectedObject),E.Z.instance.check(14)):e=!1,e&&this.annotationCanvas.render()}},n}(x);var tt=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const nt=function(t){function n(n){var e=t.call(this,n)||this;return e.keyDown=e.keyDown.bind(e),e}return tt(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("keydown",this.keyDown)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("keydown",this.keyDown)},n.prototype.keyDown=function(t){"d"!==t.key||t.ctrlKey?"a"===t.key&&(this.annotationCanvas.imageId--,E.Z.instance.check(5)):(this.annotationCanvas.imageId++,E.Z.instance.check(5))},n}(x);var et=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const ot=function(t){function n(n){var e=t.call(this,n)||this;return e.nextPage=e.nextPage.bind(e),e.previousPage=e.previousPage.bind(e),e}return et(n,t),n.prototype.on=function(){i()(".next-page").on("click",this.nextPage),i()(".previous-page").on("click",this.previousPage)},n.prototype.off=function(){i()(".next-page").off("click",this.nextPage),i()(".previous-page").off("click",this.previousPage)},n.prototype.nextPage=function(){this.annotationCanvas.imageId++,E.Z.instance.check(5)},n.prototype.previousPage=function(){this.annotationCanvas.imageId--,E.Z.instance.check(5)},n}(x);var rt=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const it=function(t){function n(n){var e=t.call(this,n)||this;return e.selectPage=e.selectPage.bind(e),e.reloadImageList=e.reloadImageList.bind(e),e.imageChanged=e.imageChanged.bind(e),e.reloadImageList(),e}return rt(n,t),n.prototype.on=function(){this.annotationCanvas.on("images",this.reloadImageList),this.annotationCanvas.on("imagechange",this.imageChanged),this.addEventListenersToList()},n.prototype.off=function(){this.annotationCanvas.off("images",this.reloadImageList),this.annotationCanvas.off("imagechange",this.imageChanged),this.removeEventListenersFromList()},n.prototype.addEventListenersToList=function(){i()(".image-collection li").on("click",this.selectPage)},n.prototype.removeEventListenersFromList=function(){i()(".image-collection li").off("click",this.selectPage)},n.prototype.selectPage=function(t){var n=t.target.getAttribute("data-image-id");if(!n)throw new Error("data-image-id attribute is missing on selected element");var e=parseInt(n,10);this.annotationCanvas.imageId=e,E.Z.instance.check(6)},n.prototype.imageChanged=function(){var t;i()(".image-collection li").removeClass("selected");var n=i()('.image-collection li[data-image-id="'.concat(this.annotationCanvas.imageId,'"]'));n.addClass("selected"),null===(t=n.get(0))||void 0===t||t.scrollIntoView()},n.prototype.reloadImageList=function(){var t=i()(".image-collection");i()(".image-collection li").remove(),this.annotationCanvas.images.forEach((function(n,e){i()(document.createElement("li")).attr("data-image-id",e).text(n.title).appendTo(t)})),this.addEventListenersToList(),this.imageChanged()},n}(x);var at=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const st=function(t){function n(n){var e=t.call(this,n)||this;return e.button=new ot(n),e.key=new nt(n),e.list=new it(n),e}return at(n,t),n.prototype.on=function(){this.button.on(),this.key.on(),this.list.on()},n.prototype.off=function(){this.button.off(),this.key.off(),this.list.off()},n}(x);var ct=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();const lt=function(t){function n(n){var e=t.call(this,n)||this;return e.wheel=e.wheel.bind(e),e}return ct(n,t),n.prototype.on=function(){this.annotationCanvas.element.addEventListener("wheel",this.wheel)},n.prototype.off=function(){this.annotationCanvas.element.removeEventListener("wheel",this.wheel)},n.prototype.wheel=function(t){if(L(t)){var n=.002*-t.deltaY;this.annotationCanvas.zoom+=n*this.annotationCanvas.zoom;var e=t.pageX*n/this.annotationCanvas.zoom,o=t.pageY*n/this.annotationCanvas.zoom;this.annotationCanvas.scrollX+=e,this.annotationCanvas.scrollY+=o,this.annotationCanvas.render(),E.Z.instance.check(4)}},n}(x),ut=function(){function t(t){this.modulesByMode=new Map,this.annotationCanvas=t;var n=new F(t),e=new I(t),r=new N(t),i=new $(t),a=[n,r,i,new T(t)],s=[e,i],c=[n,new G(t),new J(t)];this.modulesByMode.set(o.CURSOR,a),this.modulesByMode.set(o.MARK,s),this.modulesByMode.set(o.GROUP,c),a.concat(s).concat(c).forEach((function(t){return t.off()})),this.mode=o.CURSOR,this.canvasMode||(this.canvasMode=o.CURSOR),this.fullTimeModules=[new lt(t),new st(t),new k(t)],this.fullTimeModules.forEach((function(t){return t.on()})),this.annotationCanvas.element.addEventListener("selectstart",(function(t){t.preventDefault()}))}return Object.defineProperty(t.prototype,"mode",{set:function(t){this.canvasMode!==t&&(i()(".tool-name").text("".concat(a.ZP.t("tools.mode.".concat(t)))),this.off(this.canvasMode),this.on(t),this.canvasMode=t,this.annotationCanvas.render({mode:t}))},enumerable:!1,configurable:!0}),t.prototype.turnOff=function(){this.off(this.canvasMode),this.fullTimeModules.forEach((function(t){return t.off()}))},t.prototype.on=function(t){var n;null===(n=this.modulesByMode.get(t))||void 0===n||n.forEach((function(t){return t.on()}))},t.prototype.off=function(t){var n;null===(n=this.modulesByMode.get(t))||void 0===n||n.forEach((function(t){return t.off()}))},t}(),ht=function(){function t(t,n){t.on("click",this.download.bind(this)),this.dataCallback=n}return t.prototype.download=function(){var t=this.dataCallback(),n=new Blob([this.dataProcessor.processData(t)],{type:this.type}),e=document.createElement("a");e.setAttribute("download",this.dataProcessor.fileName(t)),e.setAttribute("target","blank"),e.setAttribute("href",URL.createObjectURL(n)),e.click()},t}();var pt=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),ft={processData:function(t){var n=[];t.eachObject((function(t){return n.push(t)}));var e=n.map((function(t){var n=t.klass,e=t.centerX,o=t.centerY,r=t.normalWidth,i=t.normalHeight;return[n.id,e.toPrecision(6),o.toPrecision(6),r.toPrecision(6),i.toPrecision(6)]})),o=[];return t.eachRelation((function(t){var e=t.klass,r=t.input,i=t.output;o.push([e.id,n.indexOf(r),n.indexOf(i)])})),e.push([]),e.concat(o).map((function(t){return t.join(" ")})).join("\n")},fileName:function(t){return t.imageTitle}};const dt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type="text/plain",n.dataProcessor=ft,n}return pt(n,t),n}(ht),vt=function(t,n){var e=this;this.labelSelect=i()(".object-properties .annotation-label-select").get(0),R(g.s,this.labelSelect),this.labelSelect.addEventListener("change",(function(){var o=t.currentPage;if(null==o?void 0:o.selectedObject){var r=g.s[parseInt(e.labelSelect.value,10)];o.selectedObject.klass=r,i()("".concat(n," .object-name")).text(r.title),t.render()}})),t.on("selectedObject",(function(){var o=t.currentPage;if(null==o?void 0:o.selectedObject){var r=o.selectedObject.klass;e.labelSelect.value=g.s.indexOf(r).toString(),i()(n).show(),i()("".concat(n," .object-name")).text(r.title)}else i()(n).hide()})),i()(n).hide(),i()("".concat(n," .duplicate")).on("click",(function(){var n=t.currentPage;(null==n?void 0:n.selectedObject)&&(n.selectedObject=n.collection.cloneAnnotation(n.selectedObject),t.render(),E.Z.instance.check(14))})),i()("".concat(n," .remove")).on("click",(function(){var n=t.currentPage;(null==n?void 0:n.selectedObject)&&(n.removeAnnotation(n.selectedObject),t.render(),E.Z.instance.check(15))}))};var yt=e(3311),mt=e.n(yt);const wt=function(){function t(t,n){var e=this;this.canvasControl=t,this.buttons=n,this.activate(this.buttons.first()),this.buttons.on("click",(function(t){e.activate(i()(t.target))}))}return Object.defineProperty(t.prototype,"mode",{set:function(t){var n=mt()(this.buttons,(function(n){return n.classList.contains(t)}));n&&this.activate(i()(n))},enumerable:!1,configurable:!0}),t.prototype.activate=function(t){this.buttons.removeClass("tool-active"),t.addClass("tool-active");var n=mt()(o,(function(n){return t.hasClass(n)}));n&&(this.canvasControl.mode=n,n===o.MARK?E.Z.instance.check(7):n===o.CURSOR?E.Z.instance.check(10):n===o.GROUP&&E.Z.instance.check(16))},t}();var gt=e(8718),bt=e.n(gt),Ct=e(3980),Ot=e.n(Ct),_t=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),jt=function(){return jt=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},jt.apply(this,arguments)},xt={processData:function(t){var n=[];t.eachRelation((function(t){n.push(t)}));var e=[];return t.eachObject((function(t){var o=n.filter((function(n){return n.input===t})).map((function(t){return{klass:bt()(t.klass,["title"]),output:t.output}}));e.push({annotation:jt(jt({},t),{normalX:t.normalX+t.normalWidth/2,normalY:t.normalY+t.normalHeight/2,klass:bt()(t.klass,"title")}),relations:o})})),Ot()({annotations:e,relations:g.a.filter((function(t){return"has_relation"!==t.title})).map((function(t){return bt()(t,["title"])})),classes:g.s.map((function(t){return bt()(t,["id","title"])}))})},fileName:function(t){return"".concat(t.imageTitle,".owl")}};const Pt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.type="text/owl",n.dataProcessor=xt,n}return _t(n,t),n}(ht);function kt(t){t.images.length?i()(".editor").show():i()(".editor").hide()}const Et=function(){function t(t,n){var e=this;this.annotationCanvas=new j(n),t.on("pageReload",(function(){e.load()})),this.load(),window.addEventListener("beforeunload",(function(t){t.preventDefault(),t.returnValue=""}))}return Object.defineProperty(t.prototype,"images",{set:function(t){this.annotationCanvas.images=c()(t,"title"),kt(this.annotationCanvas)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"annotations",{set:function(t){this.annotationCanvas.annotations=t},enumerable:!1,configurable:!0}),t.prototype.render=function(){this.annotationCanvas.render()},Object.defineProperty(t.prototype,"canvas",{get:function(){return this.annotationCanvas},enumerable:!1,configurable:!0}),t.prototype.load=function(){var t=this;kt(this.annotationCanvas),this.canvasControl&&this.canvasControl.turnOff(),this.canvasControl=new ut(this.annotationCanvas);var n=new wt(this.canvasControl,i()(".tool-buttons > button"));new vt(this.annotationCanvas,".object-properties"),this.annotationCanvas.element.addEventListener("keydown",(function(t){"c"===t.key?n.mode=o.CURSOR:"w"===t.key?n.mode=o.MARK:"g"===t.key?n.mode=o.GROUP:"s"===t.key&&t.ctrlKey&&(i()(".download-annotations").trigger("click"),t.preventDefault())})),i()(".clear").on("click",(function(){window.confirm(a.ZP.t("clear_annotations_from_current_image_confirm"))&&(t.annotationCanvas.currentPage.clear(),t.annotationCanvas.render())})),new dt(i()(".download-yolo-annotations"),(function(){var n=t.annotationCanvas.currentPage;return E.Z.instance.check(20),n.collection})),new Pt(i()(".download-owl-annotations"),(function(){var n=t.annotationCanvas.currentPage;return E.Z.instance.check(20),n.collection}))},t}()}}]);